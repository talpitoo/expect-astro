---
// import 'swiper/css'; // TODO debug specificity

const portfolioItems = [
  {
    id: "dreamers-inc",
    title: "Dreamers Inc.",
    content: `<blockquote class="mb-6">
                  <p class="mb-3">
                    You may say that I'm a dreamer
                    <br /> but I'm not the only one
                    <br /> I hope someday you'll join us
                    <br /> and the world will be as one.
                  </p>
                </blockquote>
                <p class="mb-3">The best client you can work with!</p>`,
    skills: [
      { name: "Bootstrap", url: "https://getbootstrap.com/" },
      { name: "Photoshop", url: "https://www.adobe.com/products/photoshop.html" },
      { name: "favicon design", url: "#" },
    ],
    link: {
      url: "https://thedreamers.us/",
      text: "thedreamers.us",
    },
  },
  {
    id: "upwork",
    title: "Upwork Global Inc.",
    content: `<p class="mb-3">oDesk is now Upwork.</p>
                <p class="mb-3">
                  Freelance marketplaces <em>Elance</em> and <em>oDesk</em> are now
                  rebranded and merged together under the new name - Upwork. It was
                  (and still is) exciting experience to be a part of the team which
                  made it happen.
                </p>`,
    skills: [
      { name: "Bootstrap", url: "https://getbootstrap.com/" },
      { name: "Vue.js", url: "https://vuejs.org/" },
      { name: "WCAG", url: "#" },
      { name: "animation system", url: "#" },
      { name: "UI Library", url: "#" },
    ],
    link: {
      url: "https://upwork.com/",
      text: "upwork.com",
    },
  },
  {
    id: "novalite",
    title: `Responsive website<br />
                  for an outsourcing company`,
    content: `<p class="mb-3">
                  A website with SVG animations and highest accessibility
                  standards. PSD by <a
                    onclick="trackOutboundLink('https://heavyform.com/'); return false;"
                    href="https://heavyform.com/"
                    class="text-primary dark:mix-blend-plus-lighter">Heavyform&#174; Creative Agency</a
                  >. Optimized with handcrafted lazy loading, Google PageSpeed
                  Insights, YSlow, Web Developer Checklist and HTML CodeSniffer.
                  The website works even with javascript disabled!
                </p>`,
    skills: [
      { name: "Bootstrap", url: "https://getbootstrap.com/" },
      { name: "skill #2", url: "#todo" },
      { name: "skill #3", url: "#todo" },
    ],
    link: {
      url: "https://talpitoo.com/novalite/",
      text: "novalite.rs",
    },
  },
  {
    id: "tt",
    title: "A personal photography blog",
    content: `<p class="mb-3">
                  Responsive Wordpress theme with preserved IPTC/EXIF data, SEO
                  friendly image names and a lot of small details. What
                  photographers actually want.
                </p>`,
    skills: [
      { name: "Bootstrap", url: "https://getbootstrap.com/" },
      { name: "skill #2", url: "#todo" },
      { name: "skill #3", url: "#todo" },
    ],
    link: {
      url: "https://tothtamas.tt/",
      text: "tothtamas.tt",
    },
  },
  {
    id: "lapetitevackor",
    title: "A customized Tumblr theme",
    content: `<p class="mb-3">
                  Custom Tumblr theme based on <a
                    onclick="trackOutboundLink('https://www.tumblr.com/theme/37310'); return false;"
                    href="https://www.tumblr.com/theme/37310"
                    class="text-primary dark:mix-blend-plus-lighter">Optica</a
                  > by <em>Kristoffer.</em> with fine tuned social sharing rules.
                  But enough with the technical details already, here, Vackor is
                  the star!
                </p>`,
    skills: [
      { name: "Bootstrap", url: "https://getbootstrap.com/" },
      { name: "skill #2", url: "#todo" },
      { name: "skill #3", url: "#todo" },
    ],
    link: {
      url: "https://lapetitevackor.tumblr.com/tagged/lapetitevackor/chrono/",
      text: "lapetitevackor.tumblr.com",
    },
  },
  {
    id: "cynkra",
    title: "Website and custom blog for a team of data scientists",
    content: `<p class="mb-3">Website redesign and migration from Bootstrap to TailwindCSS, in close collaboration with an A-list designer <a
                    onclick="trackOutboundLink('https://www.jonas.studio/'); return false;"
                    href="https://www.jonas.studio/"
                    class="text-primary dark:mix-blend-plus-lighter">Jonas Goldstein</a>. Translated a Bauhaus- and ASCII-inspired design vision into a functional, minimalist, and visually refined site — significantly lighter and faster.
                </p>`,
    skills: [
      { name: "Jekyll", url: "https://jekyllrb.com/" },
      { name: "TailwindCSS", url: "https://tailwindcss.com/" },
      {
        name: "<canvas>",
        url: "https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API",
      },
      { name: "GSAP", url: "https://greensock.com/gsap/" },
      { name: "Swiper", url: "https://swiperjs.com/" },
      {
        name: "WCAG",
        url: "https://www.w3.org/WAI/standards-guidelines/wcag/",
      },
      { name: "SEO", url: "https://moz.com/beginners-guide-to-seo" },
      {
        name: "i18n",
        url: "https://www.w3.org/International/questions/qa-i18n",
      },
      { name: "LCP", url: "https://web.dev/articles/optimize-lcp" },
    ],
    link: {
      url: "https://cynkra.com/blog/2025-04-01-launch/",
      text: "cynkra.com",
    },
  },
  {
    id: "dreamingsheep",
    title: "An online journal for your dreams and beyond",
    content: `<p class="mb-3">It is an online dream journal where you can log and analyze your dreams. Find connections in your dream patterns like mood, theme, recall, sleep cycle, repeating symbols and others.
                </p>
              <p class="sr-only">Tech stack:</p>`,
    skills: [
      { name: "MUI", url: "https://mui.com/" },
      { name: "TailwindCSS", url: "https://tailwindcss.com/" },
      { name: "BlitzJS", url: "https://blitzjs.com/" },
      { name: "Prisma", url: "https://www.prisma.io/" },
      { name: "Postgres", url: "https://www.postgresql.org/" },
      { name: "AWS S3", url: "https://aws.amazon.com/s3/" },
    ],
    link: {
      url: "https://dreamingsheep.net/",
      text: "dreamingsheep.net",
    },
  },
  {
    id: "hellmut-monz",
    title: "A static site generator and UI library",
    content: `<p class="mb-3">Custom tailored grid system; cqi [container query units]; cap height typography; both the spacing and the typography aligns with the grid, both horizontally and vertically; custom image gallery; search functionality; SVG sprite generation; sitemap, meta tags, og:images, favicons, SEO, WCAG accessibility ...and more fine details.
                </p>`,
    skills: [
      { name: "Eleventy", url: "https://www.11ty.dev/" },
      { name: "TailwindCSS", url: "https://tailwindcss.com/" },
      { name: "Flowbite", url: "https://flowbite.com/" },
      { name: "GSAP", url: "https://greensock.com/gsap/" },
      { name: "Swiper", url: "https://swiperjs.com/" },
    ],
    link: {
      url: "http://keyphilosophy.com/",
      text: "keyphilosophy.com",
    },
  },
  {
    id: "itportal",
    title: "Theme adaptation for SaaS company",
    content: `<p class="mb-3">
            Reverse-engineering a purchased static theme into an Eleventy.js 
            website with SEO and accessibility optimization, load speed 
            improvements, and search widget API integration. Microanimations, 
            adaptive dark/light-themed favicons and efficient font loading. 
            SVG animations by <a
            onclick="trackOutboundLink('https://heavyform.com/'); return false;"
            href="https://heavyform.com/"
            class="text-primary dark:mix-blend-plus-lighter">Heavyform&#174; Creative Agency</a
            >.
          </p>`,
    skills: [
      { name: "Bootstrap", url: "https://getbootstrap.com/" },
      { name: "SVG", url: "#todo" },
      { name: "load speed optimization", url: "#todo" },
    ],
    link: {
      url: "https://www.itportal.com/",
      text: "itportal.com",
    },
  },
  {
    id: "seopal",
    title: "SEOpal: Eleventy + TailwindCSS",
    content: `<p class="mb-3">From Figma to '11ty' static site with TailwindCSS and hand crafted CSS animations.
                </p>`,
    skills: [
      { name: "Bootstrap", url: "https://getbootstrap.com/" },
      { name: "skill #2", url: "#todo" },
      { name: "skill #3", url: "#todo" },
    ],
    link: {
      url: "https://seopal.io/",
      text: "seopal.io",
    },
  },
  {
    id: "tilt",
    title: "A dashboard with custom markdown rendering",
    content: `<p class="mb-3">A Next.js project using shadcn/ui as the UI lib, TailwindCSS for styling, and code highlighting via highlight.js. Markdown support with custom code blocks.
                </p>`,
    skills: [
      { name: "NextJS", url: "https://nextjs.org/" },
      { name: "TailwindCSS", url: "https://tailwindcss.com/" },
      { name: "shadcn/ui", url: "https://ui.shadcn.com/" },
      { name: "Recharts", url: "https://recharts.org/" },
    ],
    link: {
      url: "https://tilt-drab.vercel.app/",
      text: "tilt-drab.vercel.app",
    },
  },
  {
    id: "szerencsedhogyoreganyadnakszolitottal",
    title: "An AI chatbot for fun",
    content: `<p class="mb-3">A Next.js project using shadcn/ui as the UI lib, TailwindCSS for styling, and code highlighting via highlight.js. Markdown support with custom code blocks.
                </p>`,
    skills: [
      { name: "NextJS", url: "https://nextjs.org/" },
      { name: "TailwindCSS", url: "https://tailwindcss.com/" },
      { name: "shadcn/ui", url: "https://ui.shadcn.com/" },
      { name: "Recharts", url: "https://recharts.org/" },
    ],
    link: {
      url: "https://szerencsedhogyoreganyadnakszolitottal.hu/",
      text: "szerencsedhogyoreganyadnakszolitottal.hu",
    },
  },
  {
    id: "cycls",
    title: "AI chatbot and landing page",
    content: `<p class="mb-3">
                  TailwindCSS markup only, so that it can rely on <code>https://cdn.tailwindcss.com</code>
                </p>`,
    skills: [
      { name: "Bootstrap", url: "https://getbootstrap.com/" },
      { name: "skill #2", url: "#todo" },
      { name: "skill #3", url: "#todo" },
    ],
    link: {
      url: "https://cycls-landing.vercel.app/",
      text: "cycls.com",
    },
  },
  {
    id: "justplaysnake",
    title: "Online snake",
    content: `<p class="mb-3">
                  HTML5 game (React)
                </p>`,
    skills: [
      { name: "Bootstrap", url: "https://getbootstrap.com/" },
      { name: "skill #2", url: "#todo" },
      { name: "skill #3", url: "#todo" },
    ],
    link: {
      url: "https://justplaysnake.com/",
      text: "justplaysnake.com",
    },
  },
  {
    id: "forexchurch",
    title: "Forex Church",
    content: `<p class="mb-3">
                  converting a React website into a static HTML website using 11ty/Bootstrap/Alpine.js/Axios
                </p>`,
    skills: [
      { name: "Bootstrap", url: "https://getbootstrap.com/" },
      { name: "skill #2", url: "#todo" },
      { name: "skill #3", url: "#todo" },
    ],
    link: {
      url: "https://forexchurch-ten.vercel.app/",
      text: "forexchurch.com",
    },
  },
  {
    id: "dafed",
    title: "Conference speech",
    content: `<p class="mb-3">
                  I gave a talk at a conference for designers and front-end
                  developers about accessibility, user experience and
                  performance. If you are interested in <abbr
                    title="Web Content Accessibility Guidelines">WCAG</abbr
                  > 2.0, <abbr title="Accessible Rich Internet Applications"
                    >WAI-ARIA</abbr
                  > or Schema.org, check out the slides and the video at
                </p>`,
    skills: [
      { name: "Bootstrap", url: "https://getbootstrap.com/" },
      { name: "skill #2", url: "#todo" },
      { name: "skill #3", url: "#todo" },
    ],
    link: {
      url: "https://dafed.org/",
      text: "dafed.org",
    },
  },
];
---

<!-- Import Swiper CSS -->
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
/>

<section class="featured dreamers-inc pb-0!" id="portfolio">
  <!-- Progress bar - using Swiper's built-in pagination -->
  <div class="swiper-pagination absolute top-0 left-0 w-full h-1 z-10"></div>

  <div class="container-bootstrap">
    <div class="grid md:grid-cols-12 -mx-[15px]">
      <div class="md:col-span-10 md:col-start-2 px-[15px]">
        <div class="grid md:grid-cols-12 -mx-[15px]">
          <div class="md:col-span-4 px-[15px] xl:pr-0">
            <div class="relative">
              <h1 class="font-serif font-light leading-[1.1] mb-3 uppercase text-[46px] mt-0">Featured work</h1>
              <!-- Navigation -->
              <span class="swiper-navigation absolute top-0 right-0 md:right-auto md:-left-20 inline-flex items-center justify-center gap-4 leading-none">
                <button
                  class="swiper-button swiper-button-prev size-auto! font-serif! text-[90px] bg-transparent border-none"
                  type="button"
                  aria-label="Previous portfolio item"
                >
                  ‹
                </button>
                <button
                  class="swiper-button swiper-button-next size-auto! font-serif! text-[90px] bg-transparent border-none"
                  type="button"
                  aria-label="Next portfolio item"
                >
                  ›
                </button>
              </span>
            </div>
            <ul class="list-unstyled portfolio-descriptions">
              {
                portfolioItems.map((item) => (
                  <li data-id={item.id}>
                    <h2 class="font-sans font-light leading-[1.1] text-lg mb-[30px] normal-case" set:html={item.title} />
                    <Fragment set:html={item.content} />
                    {item.skills && item.skills.length > 0 && (
                      <ul class="my-6 dark:opacity-50">
                        {item.skills.map((skill) => (
                          <li class="badge mb-1.5 mr-1.5">{skill.name}</li>
                        ))}
                      </ul>
                    )}
                    <p class="mb-3">
                      <a
                        onclick={`trackOutboundLink('${item.link.url}'); return false;`}
                        href={item.link.url}
                        class="text-primary text-big dark:mix-blend-plus-lighter"
                      >
                        {item.link.text}
                      </a>
                    </p>
                  </li>
                ))
              }
            </ul>
          </div>
          <div
            class="md:col-span-8 relative max-w-[calc(100vw-55px)] md:max-w-none"
          >
            <!-- max-w-[calc(100vw-55px)] sm:max-w-none TODO -->
            <div class="nexus10 overflow-hidden">
              <div class="screen-tablet">
                <!-- Vertical swiper for tablet -->
                <div class="swiper portfolio-tablet-swiper">
                  <div class="swiper-wrapper">
                    {
                      portfolioItems.map((item) => (
                        <div data-id={item.id} data-hash={item.id} class="swiper-slide">
                          <img
                            src={`img/portfolio/${item.id}-1214x758.png?ver=28082025`}
                            alt={item.title}
                            class="w-full h-full object-cover"
                          />
                        </div>
                      ))
                    }
                  </div>
                </div>
              </div>
              <div class="nexus5 pointer-events-none">
                <div class="screen-smartphone">
                  <!-- Horizontal swiper for smartphone -->
                  <div class="swiper portfolio-smartphone-swiper pointer-events-auto">
                    <div class="swiper-wrapper">
                      {
                        portfolioItems.map((item) => (
                          <div data-id={item.id} data-hash={item.id} class="swiper-slide">
                            <img
                              src={`img/portfolio/${item.id}-356x632.png?ver=28082025`}
                              alt={item.title}
                              class="w-full h-full object-cover"
                            />
                          </div>
                        ))
                      }
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Navigation -->
  <!-- <span
    class="swiper-navigation flex items-center justify-center gap-4 font-serif text-[90px] leading-none"
  >
    <button
      class="swiper-button swiper-button-prev size-auto!"
      type="button"
      aria-label="Previous portfolio item"
    >
      ‹
    </button>
    <button
      class="swiper-button swiper-button-next size-auto!"
      type="button"
      aria-label="Next portfolio item"
    >
      ›
    </button>
  </span> -->

  <!-- Thumbs gallery -->
  <div class="swiper portfolio-thumbs-swiper mt-20 w-full">
    <div class="swiper-wrapper">
      {
        portfolioItems.map((item) => (
          <div data-id={item.id} data-hash={item.id} class="swiper-slide cursor-pointer opacity-50 hover:opacity-75 transition-opacity">
            <img
              src={`img/portfolio/${item.id}-1214x758.png?ver=28082025`}
              alt={item.title}
              class="w-full h-full object-cover"
            />
          </div>
        ))
      }
    </div>
  </div>
</section>

<!-- Import Swiper JS -->
<script
  src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"
  is:inline></script>

<script is:inline define:vars={{ portfolioItems }}>
  document.addEventListener("DOMContentLoaded", function () {
    // Show portfolio description by matching data-id (robust against loop/index quirks)
    function showDescriptionById(id) {
      if (!id) return;
      const items = document.querySelectorAll('.portfolio-descriptions > li');
      items.forEach(li => {
        li.style.display = (li.dataset.id === id) ? 'block' : 'none';
      });
    }

    // Initialize thumbs swiper first
    const thumbsSwiper = new Swiper(".portfolio-thumbs-swiper", {
      spaceBetween: 0,
      slidesPerView: 4,
      breakpoints: {
        480: {
          slidesPerView: 4,
        },
        768: {
          slidesPerView: 6,
        },
        992: {
          slidesPerView: 8,
        },
        1200: {
          slidesPerView: 8,
        },
        1600: {
          slidesPerView: 12,
        },
      },
      // hashNavigation: {
      //   watchState: true,
      // },
      freeMode: true,
      watchSlidesProgress: true,
      loop: true,
    });

    // Initialize smartphone swiper (horizontal) FIRST
    const smartphoneSwiper = new Swiper(".portfolio-smartphone-swiper", {
      direction: "horizontal",
      loop: true,
      spaceBetween: 0,
      // hashNavigation: {
      //   watchState: true,
      // },
      thumbs: {
        swiper: thumbsSwiper,
      },
      pagination: {
        el: ".swiper-pagination",
        type: "progressbar",
      },
      navigation: {
        nextEl: ".swiper-button-next",
        prevEl: ".swiper-button-prev",
      },
      on: {
        slideChange: function () {
          const active = this.slides[this.activeIndex];
          const id = active && active.getAttribute('data-id');
          showDescriptionById(id);
        },
      },
    });

    // Initialize tablet swiper (vertical) SECOND - now smartphoneSwiper exists
    const tabletSwiper = new Swiper(".portfolio-tablet-swiper", {
      direction: "vertical",
      loop: true,
      spaceBetween: 0,
      mousewheel: true, // Enable mouse wheel scrolling
      touchEventsTarget: "container", // Enable touch events
      // hashNavigation: {
      //   watchState: true,
      // },
      thumbs: {
        swiper: thumbsSwiper,
      },
    });

    // Sync swipers using controller (simpler approach)
    tabletSwiper.controller.control = smartphoneSwiper;
    smartphoneSwiper.controller.control = tabletSwiper;

    // Initialize description (first item's id)
    if (portfolioItems && portfolioItems.length) {
      showDescriptionById(portfolioItems[0].id);
    } else {
      // Fallback: show first li if any
      const firstLi = document.querySelector('.portfolio-descriptions li');
      if (firstLi) firstLi.style.display = 'block';
    }

    // Add keyboard navigation
    document.addEventListener("keydown", function (e) {
      if (e.key === "ArrowLeft" || e.key === "ArrowUp") {
        smartphoneSwiper.slidePrev();
      } else if (e.key === "ArrowRight" || e.key === "ArrowDown") {
        smartphoneSwiper.slideNext();
      }
    });
  });
</script>

<style>
  .portfolio-thumbs-swiper .swiper-slide-thumb-active {
    opacity: 1;
  }

  .portfolio-tablet-swiper,
  .portfolio-smartphone-swiper {
    height: 100%;
  }

  .swiper-slide img {
    display: block;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  /* Custom navigation buttons */
  .swiper-navigation .swiper-button-prev,
  .swiper-navigation .swiper-button-next {
    position: static;
    margin: 0;
    width: 48px;
    height: 48px;
  }

  .swiper-navigation .swiper-button-prev:after,
  .swiper-navigation .swiper-button-next:after {
    display: none;
  }

  /* Style Swiper's built-in progress bar */
  .swiper-pagination-progressbar {
    background: rgba(156, 163, 175, 0.2); /* bg-gray-400/20 */
  }

  .swiper-pagination-progressbar .swiper-pagination-progressbar-fill {
    background: var(--color-primary) !important;
  }
</style>
